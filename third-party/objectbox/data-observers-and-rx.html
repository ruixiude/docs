<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Data Observers &amp; Rx | 文档管理中心</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="瑞修得移动开发小组文档管理中心">
    
    <link rel="preload" href="/docs/assets/css/0.styles.901409fb.css" as="style"><link rel="preload" href="/docs/assets/js/app.1dda1ef8.js" as="script"><link rel="preload" href="/docs/assets/js/2.1637da50.js" as="script"><link rel="preload" href="/docs/assets/js/92.183da242.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.58dfe90f.js"><link rel="prefetch" href="/docs/assets/js/100.5c67fc3e.js"><link rel="prefetch" href="/docs/assets/js/101.3e719c16.js"><link rel="prefetch" href="/docs/assets/js/102.98816141.js"><link rel="prefetch" href="/docs/assets/js/103.0a5c3a01.js"><link rel="prefetch" href="/docs/assets/js/104.a55d0f0c.js"><link rel="prefetch" href="/docs/assets/js/105.59340145.js"><link rel="prefetch" href="/docs/assets/js/106.b8154cda.js"><link rel="prefetch" href="/docs/assets/js/107.22f6f4f3.js"><link rel="prefetch" href="/docs/assets/js/108.ac08dac5.js"><link rel="prefetch" href="/docs/assets/js/109.261bb23c.js"><link rel="prefetch" href="/docs/assets/js/11.be546261.js"><link rel="prefetch" href="/docs/assets/js/110.40e9908d.js"><link rel="prefetch" href="/docs/assets/js/111.d0bf2613.js"><link rel="prefetch" href="/docs/assets/js/112.acf2ec43.js"><link rel="prefetch" href="/docs/assets/js/113.adea7e7c.js"><link rel="prefetch" href="/docs/assets/js/114.4215f03c.js"><link rel="prefetch" href="/docs/assets/js/115.664f3b94.js"><link rel="prefetch" href="/docs/assets/js/116.721268c9.js"><link rel="prefetch" href="/docs/assets/js/117.592435d2.js"><link rel="prefetch" href="/docs/assets/js/118.fea53932.js"><link rel="prefetch" href="/docs/assets/js/119.720b40e9.js"><link rel="prefetch" href="/docs/assets/js/12.a3a13835.js"><link rel="prefetch" href="/docs/assets/js/120.0816f4ee.js"><link rel="prefetch" href="/docs/assets/js/121.5e9d7e69.js"><link rel="prefetch" href="/docs/assets/js/122.b6a3fdf0.js"><link rel="prefetch" href="/docs/assets/js/123.58800fd8.js"><link rel="prefetch" href="/docs/assets/js/124.7764b45f.js"><link rel="prefetch" href="/docs/assets/js/125.bf736276.js"><link rel="prefetch" href="/docs/assets/js/126.096778ee.js"><link rel="prefetch" href="/docs/assets/js/127.7f3b491a.js"><link rel="prefetch" href="/docs/assets/js/128.2c976ed6.js"><link rel="prefetch" href="/docs/assets/js/129.1558b942.js"><link rel="prefetch" href="/docs/assets/js/13.d66ff325.js"><link rel="prefetch" href="/docs/assets/js/130.521d4737.js"><link rel="prefetch" href="/docs/assets/js/131.28349f1c.js"><link rel="prefetch" href="/docs/assets/js/132.18530a22.js"><link rel="prefetch" href="/docs/assets/js/133.46e03b94.js"><link rel="prefetch" href="/docs/assets/js/134.e8ad93d1.js"><link rel="prefetch" href="/docs/assets/js/135.776ec045.js"><link rel="prefetch" href="/docs/assets/js/136.d546aafe.js"><link rel="prefetch" href="/docs/assets/js/137.93461a95.js"><link rel="prefetch" href="/docs/assets/js/138.2f9a75db.js"><link rel="prefetch" href="/docs/assets/js/139.bb135f58.js"><link rel="prefetch" href="/docs/assets/js/14.586917b9.js"><link rel="prefetch" href="/docs/assets/js/140.6097bf59.js"><link rel="prefetch" href="/docs/assets/js/141.6a6d651b.js"><link rel="prefetch" href="/docs/assets/js/142.d26aa58e.js"><link rel="prefetch" href="/docs/assets/js/143.23821827.js"><link rel="prefetch" href="/docs/assets/js/144.3a4c36b1.js"><link rel="prefetch" href="/docs/assets/js/145.2824b080.js"><link rel="prefetch" href="/docs/assets/js/146.b1e8893f.js"><link rel="prefetch" href="/docs/assets/js/147.d54b971f.js"><link rel="prefetch" href="/docs/assets/js/148.369df7cc.js"><link rel="prefetch" href="/docs/assets/js/149.1bf135cd.js"><link rel="prefetch" href="/docs/assets/js/15.719b9ed4.js"><link rel="prefetch" href="/docs/assets/js/16.801ae469.js"><link rel="prefetch" href="/docs/assets/js/17.caf90ccc.js"><link rel="prefetch" href="/docs/assets/js/18.9b1430b4.js"><link rel="prefetch" href="/docs/assets/js/19.a7ce47c6.js"><link rel="prefetch" href="/docs/assets/js/20.c6f145a7.js"><link rel="prefetch" href="/docs/assets/js/21.96ad3811.js"><link rel="prefetch" href="/docs/assets/js/22.8b467667.js"><link rel="prefetch" href="/docs/assets/js/23.12614503.js"><link rel="prefetch" href="/docs/assets/js/24.9fd2bb95.js"><link rel="prefetch" href="/docs/assets/js/25.1666b1f6.js"><link rel="prefetch" href="/docs/assets/js/26.59796892.js"><link rel="prefetch" href="/docs/assets/js/27.99afdda0.js"><link rel="prefetch" href="/docs/assets/js/28.b4d6b486.js"><link rel="prefetch" href="/docs/assets/js/29.afbc8554.js"><link rel="prefetch" href="/docs/assets/js/3.3c077cdd.js"><link rel="prefetch" href="/docs/assets/js/30.707e9271.js"><link rel="prefetch" href="/docs/assets/js/31.1f01bd11.js"><link rel="prefetch" href="/docs/assets/js/32.58b8cdf9.js"><link rel="prefetch" href="/docs/assets/js/33.5e6d8fb9.js"><link rel="prefetch" href="/docs/assets/js/34.7a9c9f16.js"><link rel="prefetch" href="/docs/assets/js/35.314a3788.js"><link rel="prefetch" href="/docs/assets/js/36.54191cc3.js"><link rel="prefetch" href="/docs/assets/js/37.44382138.js"><link rel="prefetch" href="/docs/assets/js/38.5380da44.js"><link rel="prefetch" href="/docs/assets/js/39.34ebb7c0.js"><link rel="prefetch" href="/docs/assets/js/4.b333c14c.js"><link rel="prefetch" href="/docs/assets/js/40.0453b798.js"><link rel="prefetch" href="/docs/assets/js/41.36d65bc4.js"><link rel="prefetch" href="/docs/assets/js/42.04cba918.js"><link rel="prefetch" href="/docs/assets/js/43.ee454731.js"><link rel="prefetch" href="/docs/assets/js/44.256c268b.js"><link rel="prefetch" href="/docs/assets/js/45.7a79bfa1.js"><link rel="prefetch" href="/docs/assets/js/46.71832f87.js"><link rel="prefetch" href="/docs/assets/js/47.102136b0.js"><link rel="prefetch" href="/docs/assets/js/48.1b555eed.js"><link rel="prefetch" href="/docs/assets/js/49.2dad9744.js"><link rel="prefetch" href="/docs/assets/js/5.80d7978e.js"><link rel="prefetch" href="/docs/assets/js/50.2bffebce.js"><link rel="prefetch" href="/docs/assets/js/51.67de7f5b.js"><link rel="prefetch" href="/docs/assets/js/52.1fb2cbfa.js"><link rel="prefetch" href="/docs/assets/js/53.86f280a5.js"><link rel="prefetch" href="/docs/assets/js/54.ba5fd39f.js"><link rel="prefetch" href="/docs/assets/js/55.fbf0c266.js"><link rel="prefetch" href="/docs/assets/js/56.78f10d2c.js"><link rel="prefetch" href="/docs/assets/js/57.5a2a2006.js"><link rel="prefetch" href="/docs/assets/js/58.19058959.js"><link rel="prefetch" href="/docs/assets/js/59.7c1efd15.js"><link rel="prefetch" href="/docs/assets/js/6.93c23e29.js"><link rel="prefetch" href="/docs/assets/js/60.500e14b5.js"><link rel="prefetch" href="/docs/assets/js/61.ba85c18e.js"><link rel="prefetch" href="/docs/assets/js/62.6a199316.js"><link rel="prefetch" href="/docs/assets/js/63.e778bbfe.js"><link rel="prefetch" href="/docs/assets/js/64.c69ba645.js"><link rel="prefetch" href="/docs/assets/js/65.66afc7d5.js"><link rel="prefetch" href="/docs/assets/js/66.c60f23f3.js"><link rel="prefetch" href="/docs/assets/js/67.35ea2d93.js"><link rel="prefetch" href="/docs/assets/js/68.6f128c5c.js"><link rel="prefetch" href="/docs/assets/js/69.e8601092.js"><link rel="prefetch" href="/docs/assets/js/7.e0defabf.js"><link rel="prefetch" href="/docs/assets/js/70.e15c66b9.js"><link rel="prefetch" href="/docs/assets/js/71.65a385e6.js"><link rel="prefetch" href="/docs/assets/js/72.fddf5dc9.js"><link rel="prefetch" href="/docs/assets/js/73.b55e21d6.js"><link rel="prefetch" href="/docs/assets/js/74.78f2bb84.js"><link rel="prefetch" href="/docs/assets/js/75.3291174d.js"><link rel="prefetch" href="/docs/assets/js/76.ca315e89.js"><link rel="prefetch" href="/docs/assets/js/77.8f31a3ff.js"><link rel="prefetch" href="/docs/assets/js/78.4df66be0.js"><link rel="prefetch" href="/docs/assets/js/79.7b82ad6e.js"><link rel="prefetch" href="/docs/assets/js/8.d96ec7b2.js"><link rel="prefetch" href="/docs/assets/js/80.4aa5f85b.js"><link rel="prefetch" href="/docs/assets/js/81.ee0c5d7a.js"><link rel="prefetch" href="/docs/assets/js/82.f5d076b2.js"><link rel="prefetch" href="/docs/assets/js/83.b7d9c0c6.js"><link rel="prefetch" href="/docs/assets/js/84.c8b235a0.js"><link rel="prefetch" href="/docs/assets/js/85.a2f95b9e.js"><link rel="prefetch" href="/docs/assets/js/86.dd6142ae.js"><link rel="prefetch" href="/docs/assets/js/87.d068751e.js"><link rel="prefetch" href="/docs/assets/js/88.18f2cebe.js"><link rel="prefetch" href="/docs/assets/js/89.cdb95e7d.js"><link rel="prefetch" href="/docs/assets/js/9.2bf6fce9.js"><link rel="prefetch" href="/docs/assets/js/90.c40ac454.js"><link rel="prefetch" href="/docs/assets/js/91.6f03a350.js"><link rel="prefetch" href="/docs/assets/js/93.4abdb53c.js"><link rel="prefetch" href="/docs/assets/js/94.96d80901.js"><link rel="prefetch" href="/docs/assets/js/95.08358998.js"><link rel="prefetch" href="/docs/assets/js/96.61287424.js"><link rel="prefetch" href="/docs/assets/js/97.a0c32235.js"><link rel="prefetch" href="/docs/assets/js/98.ee4911f9.js"><link rel="prefetch" href="/docs/assets/js/99.fae638a9.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.901409fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">文档管理中心</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Third Party" class="dropdown-title"><span class="title">Third Party</span> <span class="arrow down"></span></button> <button type="button" aria-label="Third Party" class="mobile-dropdown-title"><span class="title">Third Party</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/third-party/arouter/" class="nav-link">
  ARouter
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/bugly/" class="nav-link">
  Bugly
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/dokka/" class="nav-link">
  Dokka
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/greendao/" class="nav-link">
  greenDAO
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/koin/" class="nav-link">
  Koin
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mars/" class="nav-link">
  Mars
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mmkv/" class="nav-link">
  MMKV
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mtj/" class="nav-link">
  百度移动统计
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/objectbox/" class="nav-link router-link-active">
  Objectbox
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/okhttp/" class="nav-link">
  OkHttp
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/orhanobut-logger/" class="nav-link">
  Orhanobut Logger
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/retrofit/" class="nav-link">
  Retrofit
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/rxjava/" class="nav-link">
  Rxjava
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/umeng/" class="nav-link">
  友盟+
</a></li></ul></div></div><div class="nav-item"><a href="https://ruixiude.github.io/apidocs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线API文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Third Party" class="dropdown-title"><span class="title">Third Party</span> <span class="arrow down"></span></button> <button type="button" aria-label="Third Party" class="mobile-dropdown-title"><span class="title">Third Party</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/third-party/arouter/" class="nav-link">
  ARouter
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/bugly/" class="nav-link">
  Bugly
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/dokka/" class="nav-link">
  Dokka
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/greendao/" class="nav-link">
  greenDAO
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/koin/" class="nav-link">
  Koin
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mars/" class="nav-link">
  Mars
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mmkv/" class="nav-link">
  MMKV
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/mtj/" class="nav-link">
  百度移动统计
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/objectbox/" class="nav-link router-link-active">
  Objectbox
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/okhttp/" class="nav-link">
  OkHttp
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/orhanobut-logger/" class="nav-link">
  Orhanobut Logger
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/retrofit/" class="nav-link">
  Retrofit
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/rxjava/" class="nav-link">
  Rxjava
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/docs/third-party/umeng/" class="nav-link">
  友盟+
</a></li></ul></div></div><div class="nav-item"><a href="https://ruixiude.github.io/apidocs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线API文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/third-party/objectbox/" aria-current="page" class="sidebar-link">ObjectBox Java (Kotlin, Android)</a></li><li><a href="/docs/third-party/objectbox/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/docs/third-party/objectbox/tutoial-demo-project.html" class="sidebar-link">Tutorial: Demo Project</a></li><li><a href="/docs/third-party/objectbox/entity-annotations.html" class="sidebar-link">Entity Annotations</a></li><li><a href="/docs/third-party/objectbox/kotlin-support.html" class="sidebar-link">Kotlin Support</a></li><li><a href="/docs/third-party/objectbox/queries.html" class="sidebar-link">ObjectBox Queries</a></li><li><a href="/docs/third-party/objectbox/data-observers-and-rx.html" aria-current="page" class="active sidebar-link">Data Observers &amp; Rx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#objectbox-data-observers-and-reactive-extensions" class="sidebar-link">ObjectBox  - Data Observers and Reactive Extensions</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#reactive-observers-a-first-example" class="sidebar-link">Reactive Observers: A first Example</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#data-observers-basics" class="sidebar-link">Data Observers Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#observing-general-changes" class="sidebar-link">Observing General Changes</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#observing-queries" class="sidebar-link">Observing Queries</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#canceling-subscriptions" class="sidebar-link">Canceling Subscriptions</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#observers-and-transactions" class="sidebar-link">Observers and Transactions</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#reactive-extensions" class="sidebar-link">Reactive Extensions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#thread-scheduling" class="sidebar-link">Thread Scheduling</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#transforming-data" class="sidebar-link">Transforming Data</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#errorobserver" class="sidebar-link">ErrorObserver</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#single-notifications-vs-only-changes" class="sidebar-link">Single Notifications vs. Only-Changes</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#weak-references" class="sidebar-link">Weak References</a></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#threading-overview" class="sidebar-link">Threading overview</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/third-party/objectbox/data-observers-and-rx.html#objectbox-rxjava-extension-library" class="sidebar-link">ObjectBox RxJava Extension Library</a></li></ul></li><li><a href="/docs/third-party/objectbox/relations.html" class="sidebar-link">Relations</a></li><li><a href="/docs/third-party/objectbox/data-browser.html" class="sidebar-link">Data Browser</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Android</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Advanced</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="data-observers-rx"><a href="#data-observers-rx" class="header-anchor">#</a> Data Observers &amp; Rx</h1> <p>How to observe box and query changes using ObjectBox, how to integrate with RxJava.</p> <h2 id="objectbox-data-observers-and-reactive-extensions"><a href="#objectbox-data-observers-and-reactive-extensions" class="header-anchor">#</a> ObjectBox  - Data Observers and Reactive Extensions</h2> <p>ObjectBox makes it easy for your app to react to data changes by providing:</p> <ul><li>data observers,</li> <li>reactive extensions,</li> <li>and an optional library to work with RxJava.</li></ul> <p>This makes setting up data flows easy while taking care of threading details.</p> <h2 id="reactive-observers-a-first-example"><a href="#reactive-observers-a-first-example" class="header-anchor">#</a> Reactive Observers: A first Example</h2> <p>Let’s start with an example to demonstrate what you can do with reactive data observers:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Keep a reference until the subscription is cancelled</span>
<span class="token comment">// to avoid garbage collection.</span>
<span class="token keyword">private</span> <span class="token class-name">DataSubscription</span> subscription<span class="token punctuation">;</span>

<span class="token comment">// ...</span>

<span class="token comment">// Build a regular query.</span>
<span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> taskBox<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token class-name">Task_</span><span class="token punctuation">.</span>complete<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Subscribe to its results.</span>
subscription <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token class-name">AndroidScheduler</span><span class="token punctuation">.</span><span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>data <span class="token operator">-&gt;</span> <span class="token function">updateResultDisplay</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cancel to no longer receive updates (e.g. leaving screen).</span>
subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">updateResultDisplay</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// Do something with the given tasks.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>The first line creates a regular query to get <code>Task</code> objects where <code>task.complete == false</code>. The second line connects an observer to the query. This is what happens:</p> <ul><li>the query is executed in the background</li> <li>once the query finishes the observer gets the result data</li> <li>whenever changes are made to <code>Task</code> objects in the future, the query will be executed again</li> <li>once updated query results are in, they are propagated to the observer</li> <li>the observer is called on Android’s main thread</li></ul> <p>Now, let’s dive into the details.</p> <h2 id="data-observers-basics"><a href="#data-observers-basics" class="header-anchor">#</a> Data Observers Basics</h2> <p>When objects change, ObjectBox notifies subscribed data observers. They can either subscribe to changes of certain object types (via BoxStore) or to query results. To create a data observer you need to implement the generic <code>io.objectbox.reactive.DataObserver</code> interface:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataObserver</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">onData</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This observer will be called by ObjectBox when necessary: typically shortly after subscribing and when data changes.</p> <blockquote><p>Note: <code>onData()</code> is called asynchronously and decoupled from the thread causing the data change (like the thread that committed a transaction).</p></blockquote> <h3 id="observing-general-changes"><a href="#observing-general-changes" class="header-anchor">#</a> Observing General Changes</h3> <p><code>BoxStore</code> allows a <code>DataObserver</code> to subscribe to object types. Let’s say we have a to-do list app where <code>Task</code> objects get added. To get notified when <code>Task</code> objects are added in another place in our app we can do the following:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">DataObserver</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> taskObserver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataObserver</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onData</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// do something</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
boxStore<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">Task</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>taskObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Here <code>onData()</code> is not called with anything useful as data. If you need more than being notified, like to get a list of <code>Task</code> objects following the above example, read on to learn how to observe queries.</p> <blockquote><p>Note: there is also <code>subscribe()</code> which takes no arguments. It subscribes the observer to receive changes for all available object classes.</p></blockquote> <h3 id="observing-queries"><a href="#observing-queries" class="header-anchor">#</a> Observing Queries</h3> <p>ObjectBox let’s you <a href="https://docs.objectbox.io/queries" target="_blank" rel="noopener noreferrer">build queries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to find the objects matching certain criteria. Queries are an essential part of ObjectBox: whenever you need a specific set of data, you will probably use a query.</p> <p>Combining queries and observers results in a convenient and powerful tool: query observers will automatically deliver fresh results whenever changes are made to entities in a box. Let’s say you display a list of to-do tasks in your app. You can use a DataObserver to get all tasks that are not yet completed and pass them to a method updateUi()  (note that we are using lambda syntax here):</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> taskBox<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token class-name">Task_</span><span class="token punctuation">.</span>completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subscription <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>data <span class="token operator">-&gt;</span> <span class="token function">updateResultDisplay</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>So when is our observer lambda called? Immediately when an observer is subscribed, the query will be run in a separate thread. Once the query result is available, it will be passed to the observer. This is the first call to the observer.</p> <p>Now let’s say a task gets changed and stored in ObjectBox. It doesn't matter where and how; it might be the user who marked a task as completed, or some backend thread putting additional tasks during synchronization with a server. In any case, the query will notify all observers with (potentially) updated query results.</p> <p>Note that this pattern can greatly simplify your code: there is a single place where your data comes in to update your user interface. There is no separate initialization code, no wiring of events, no re-running queries, etc.</p> <p>See the <a href="http://objectbox.io/files/objectbox-java/current/io/objectbox/query/Query.html#subscribe--" target="_blank" rel="noopener noreferrer">subscribe()-method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> documentation for more details.</p> <h3 id="canceling-subscriptions"><a href="#canceling-subscriptions" class="header-anchor">#</a> Canceling Subscriptions</h3> <p>When you call <code>observer()</code>, it returns a subscription object implementing the <code>io.objectbox.reactive.DataSubscription</code> interface:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataSubscription</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">isCanceled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Keep a reference to the <code>DataSubscription</code> for as long as results should be received, otherwise it can be garbage collected at any point. Also call <code>cancel()</code> on it once the observer should not be notified anymore, e.g. when leaving the current screen:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Keep a reference for as long as updates should be received.</span>
<span class="token class-name">DataSubscription</span> subscription <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>myObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// To no longer receive updates (e.g. leaving screen):</span>
subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>If you have more than one query subscription, you might find it useful to create a  <code>DataSubscriptionList</code> instance instead to keep track of multiple  <code>DataSubscription</code> objects. Pass the list to the <code>query.subscribe(subList)</code> overload. A basic example goes like this:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">DataSubscriptionList</span> subscriptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSubscriptionList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">A</span><span class="token punctuation">&gt;</span></span> queryA <span class="token operator">=</span> boxA<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  queryA<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>someObserverForAs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">B</span><span class="token punctuation">&gt;</span></span> queryB <span class="token operator">=</span> boxB<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  queryB<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>someObserverForBs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Cancels both subscriptions (for A and B).</span>
  subscriptions<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>Note: On Android, you would typically create the subscription in one of the <code>onCreate()/onStart()/onResume()</code> lifecycle methods and cancel it in its counterpart  <code>onDestroy()/onStop()/onPause()</code>.</p></blockquote> <h3 id="observers-and-transactions"><a href="#observers-and-transactions" class="header-anchor">#</a> Observers and Transactions</h3> <p>Observer notifications occur after a transaction is committed. For some scenarios it is especially important to know transaction bounds. If you call <code>box.put()</code> or <code>remove()</code> individually, an implicit transaction is started and committed. For example, this code fragment would trigger data observers on <code>User.class</code> twice:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>box<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>friendUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>myUser<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Log:</span>
<span class="token comment">// User friendUser put.</span>
<span class="token comment">// Observers of User called.</span>
<span class="token comment">// User myUser put.</span>
<span class="token comment">// Observers of User called.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>There are several ways to combine several operations into one transaction, for example using one of the <code>runInTx()</code> or <code>callInTx()</code> methods in the BoxStore class. For our simple example, we can simply use an overload of <code>put()</code> accepting multiple objects:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>box<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>friendUser<span class="token punctuation">,</span> myUser<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Log:</span>
<span class="token comment">// Users friendUser and myUser put.</span>
<span class="token comment">// Observers of User called.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>This results in a single transaction and thus in a single <code>DataObserver</code> notification.</p> <h2 id="reactive-extensions"><a href="#reactive-extensions" class="header-anchor">#</a> Reactive Extensions</h2> <p>In the first part you saw how data observers can help you keep your app state up to date. But there is more: ObjectBox comes with simple and convenient reactive extensions for typical tasks. While most of these are inspired by RxJava, they are not actually based on RxJava. ObjectBox brings its own features because not all developers are familiar with RxJava (for the RxJava ObjectBox library see below). We do not want to impose the complexity (Rx is almost like a new language to learn) and size of RxJava (~10k methods) on everyone. So, let’s keep it simple and neat for now.</p> <h3 id="thread-scheduling"><a href="#thread-scheduling" class="header-anchor">#</a> Thread Scheduling</h3> <p>On Android, UI updates must occur on the main thread only. Luckily, ObjectBox allows to switch the observer from a background thread over to the main thread. Let’s take a look on a revised version of the to-do task example from above:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Query</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Task</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> taskBox<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token class-name">Task_</span><span class="token punctuation">.</span>complete<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// updateResultDisplay is always called on the Android main thread.</span>
subscription <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token class-name">AndroidScheduler</span><span class="token punctuation">.</span><span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>data <span class="token operator">-&gt;</span> <span class="token function">updateResultDisplay</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Where is the difference? The additional <code>on()</code> call is all that is needed to tell where we want our observer to be called. <code>AndroidScheduler.mainThread()</code> is a built-in scheduler implementation. Alternatively, you can create an <code>AndroidScheduler</code> using a custom <code>Looper</code>, or build a fully custom scheduler by implementing the <code>io.objectbox.reactive.Scheduler</code> interface.</p> <h3 id="transforming-data"><a href="#transforming-data" class="header-anchor">#</a> Transforming Data</h3> <p>Maybe you want to transform the data before you hand it over to an observer. Let’s say, you want to keep track of the count of all stored objects for each type. The BoxStore subscription gives you the classes of the objects, and this example shows you how to transform them into actual object counts:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>subscription <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>clazz <span class="token operator">-&gt;</span> <span class="token keyword">return</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">observer</span><span class="token punctuation">(</span>count <span class="token operator">-&gt;</span> <span class="token function">updateCount</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Note that the transform operation takes a <code>Class</code> object and returns a <code>Long</code> number. Thus the <code>DataObserver</code> receives the object count as a <code>Long</code> parameter in <code>onData()</code>.</p> <p>While the lambda syntax is nice and brief, let’s look at the <code>io.objectbox.reactive.Transformer</code> interface for clarification of what the <code>transform()</code> method expects as a parameter:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataTransformer</span><span class="token generics"><span class="token punctuation">&lt;</span>FROM<span class="token punctuation">,</span> TO<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">TO</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">FROM</span> source<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Some additional notes on transformers:</p> <ul><li>Transforms are not required to actually “transform” any data. Technically, it is fine to return the same data that is received and just do some processing with (or without) it.</li> <li>Transformers are always executed asynchronously. It is fine to perform long lasting operations.</li></ul> <h3 id="errorobserver"><a href="#errorobserver" class="header-anchor">#</a> ErrorObserver</h3> <p>Maybe you noticed that a transformer may throw any type of exception. Also, a <code>DataObserver</code> might throw a <code>RuntimeException</code>. In both cases, you can provide an <code>ErrorObserver</code> to be notified about an exception that occurred. The <code>io.objectbox.reactive.ErrorObserver</code> is straight-forward:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ErrorObserver</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> th<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>To specify your <code>ErrorObserver</code>, simply call the <code>onError()</code> method after <code>subscribe()</code>.</p> <h3 id="single-notifications-vs-only-changes"><a href="#single-notifications-vs-only-changes" class="header-anchor">#</a> Single Notifications vs. Only-Changes</h3> <p>When you subscribe to a query, the <code>DataObserver</code> gets both of the following by default:</p> <ul><li>Initial query results (right after subscribing)</li> <li>Updated query results (underlying data was changed)</li></ul> <p>Sometimes you may by interested in only one of those. This is what the methods <code>single()</code> and <code>onlyChanges()</code> are for (call them after <code>subscribe()</code>). Single subscriptions are special in the way that they are cancelled automatically once the observer is notified. You can still cancel them manually to ensure no call to the observer is made at a certain point.</p> <h3 id="weak-references"><a href="#weak-references" class="header-anchor">#</a> Weak References</h3> <p>Sometimes it may be nice to have a weak reference to a data observer. Note that for the sake of a deterministic flow, it is advisable to cancel subscriptions explicitly whenever possible. If that does not scare you off, use <code>weak()</code> after <code>subscribe()</code>.</p> <h3 id="threading-overview"><a href="#threading-overview" class="header-anchor">#</a> Threading overview</h3> <p>To summarize threading as discussed earlier:</p> <ul><li>Query execution runs on a background thread (exclusive for this task)</li> <li><code>DataTransformer</code> runs on a background thread (exclusive for this task)</li> <li><code>DataObserver</code> and <code>ErrorObserver</code> run on a background thread unless a scheduler is specified via the <code>on()</code> method.</li></ul> <h2 id="objectbox-rxjava-extension-library"><a href="#objectbox-rxjava-extension-library" class="header-anchor">#</a> ObjectBox RxJava Extension Library</h2> <p>By design, there are zero dependencies on any Rx libraries in the core of ObjectBox. As you saw before ObjectBox gives you simple means to transform data, asynchronous processing, thread scheduling, and one time (single) notifications. However, you still might want to integrate with the mighty RxJava 2 (we have no plans to support RxJava 1). For this purpose we created the ObjectBox RxJava extension library:</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>implementation <span class="token string gstring">&quot;io.objectbox:objectbox-rxjava:<span class="token expression"><span class="token punctuation">$</span>objectboxVersion</span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>It provides the classes <code>RxQuery</code> and <code>RxBoxStore</code>. Both offer static methods to subscribe using RxJava means.</p> <p>For general object changes, you can use <code>RxBoxStore</code> to create an <code>Observable</code>. <code>RxQuery</code> allows to subscribe to query objects using:</p> <ul><li>Flowable</li> <li>Observable</li> <li>Single</li></ul> <p>Example usage:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Keep a reference until the disposable is disposed</span>
<span class="token comment">// to avoid garbage collection.</span>
<span class="token keyword">private</span> <span class="token class-name">Disposable</span> disposable<span class="token punctuation">;</span>

<span class="token comment">// ...</span>

<span class="token class-name">Query</span> query <span class="token operator">=</span> box<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
disposable <span class="token operator">=</span> <span class="token class-name">RxQuery</span><span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The extension library is open-source and available <a href="https://github.com/objectbox/objectbox-java/tree/master/objectbox-rxjava" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/third-party/objectbox/queries.html" class="prev">
        ObjectBox Queries
      </a></span> <span class="next"><a href="/docs/third-party/objectbox/relations.html">
        Relations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.1dda1ef8.js" defer></script><script src="/docs/assets/js/2.1637da50.js" defer></script><script src="/docs/assets/js/92.183da242.js" defer></script>
  </body>
</html>
