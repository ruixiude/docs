<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Relations | 文档管理中心</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="瑞修得移动开发小组文档管理中心">
    
    <link rel="preload" href="/assets/css/0.styles.e0cd40c5.css" as="style"><link rel="preload" href="/assets/js/app.708bd31f.js" as="script"><link rel="preload" href="/assets/js/2.1637da50.js" as="script"><link rel="preload" href="/assets/js/93.3a4310ca.js" as="script"><link rel="prefetch" href="/assets/js/10.671ef702.js"><link rel="prefetch" href="/assets/js/100.1719235d.js"><link rel="prefetch" href="/assets/js/101.41c73b12.js"><link rel="prefetch" href="/assets/js/102.4a7c53ec.js"><link rel="prefetch" href="/assets/js/103.0a5c3a01.js"><link rel="prefetch" href="/assets/js/104.a55d0f0c.js"><link rel="prefetch" href="/assets/js/105.761a51a7.js"><link rel="prefetch" href="/assets/js/106.f2fc33ad.js"><link rel="prefetch" href="/assets/js/107.8d90051f.js"><link rel="prefetch" href="/assets/js/108.ac08dac5.js"><link rel="prefetch" href="/assets/js/109.e4ba296f.js"><link rel="prefetch" href="/assets/js/11.74d91dbd.js"><link rel="prefetch" href="/assets/js/110.8b99d3d7.js"><link rel="prefetch" href="/assets/js/111.b8079109.js"><link rel="prefetch" href="/assets/js/112.2b876618.js"><link rel="prefetch" href="/assets/js/113.8ed4fb9a.js"><link rel="prefetch" href="/assets/js/114.c7574062.js"><link rel="prefetch" href="/assets/js/115.679d2f31.js"><link rel="prefetch" href="/assets/js/116.e0690ce3.js"><link rel="prefetch" href="/assets/js/117.28a45e3d.js"><link rel="prefetch" href="/assets/js/118.532bbf52.js"><link rel="prefetch" href="/assets/js/119.81a187be.js"><link rel="prefetch" href="/assets/js/12.5a779a5e.js"><link rel="prefetch" href="/assets/js/120.4785d696.js"><link rel="prefetch" href="/assets/js/121.5e9d7e69.js"><link rel="prefetch" href="/assets/js/122.b6a3fdf0.js"><link rel="prefetch" href="/assets/js/123.6f182ec1.js"><link rel="prefetch" href="/assets/js/124.e732f420.js"><link rel="prefetch" href="/assets/js/125.9ebe2714.js"><link rel="prefetch" href="/assets/js/126.ab0e1f77.js"><link rel="prefetch" href="/assets/js/127.a1553ed7.js"><link rel="prefetch" href="/assets/js/128.06c1e104.js"><link rel="prefetch" href="/assets/js/129.c98bcfdd.js"><link rel="prefetch" href="/assets/js/13.19b1f5af.js"><link rel="prefetch" href="/assets/js/130.459a2359.js"><link rel="prefetch" href="/assets/js/131.d5c4610a.js"><link rel="prefetch" href="/assets/js/132.64ddf927.js"><link rel="prefetch" href="/assets/js/133.d9af96cb.js"><link rel="prefetch" href="/assets/js/134.28448611.js"><link rel="prefetch" href="/assets/js/135.a1940886.js"><link rel="prefetch" href="/assets/js/136.47630df4.js"><link rel="prefetch" href="/assets/js/137.d1302ead.js"><link rel="prefetch" href="/assets/js/138.076aa01b.js"><link rel="prefetch" href="/assets/js/139.840c94af.js"><link rel="prefetch" href="/assets/js/14.68ae7e90.js"><link rel="prefetch" href="/assets/js/140.285e384c.js"><link rel="prefetch" href="/assets/js/141.53100d40.js"><link rel="prefetch" href="/assets/js/142.8751ffcd.js"><link rel="prefetch" href="/assets/js/143.6a99ea4e.js"><link rel="prefetch" href="/assets/js/144.92ed9788.js"><link rel="prefetch" href="/assets/js/145.46d45fe6.js"><link rel="prefetch" href="/assets/js/146.0d5e1907.js"><link rel="prefetch" href="/assets/js/147.1d45b414.js"><link rel="prefetch" href="/assets/js/148.3c1d7857.js"><link rel="prefetch" href="/assets/js/149.6e71cd9c.js"><link rel="prefetch" href="/assets/js/15.e4274f77.js"><link rel="prefetch" href="/assets/js/16.29ac15df.js"><link rel="prefetch" href="/assets/js/17.79577068.js"><link rel="prefetch" href="/assets/js/18.7aa649ac.js"><link rel="prefetch" href="/assets/js/19.ce2c2516.js"><link rel="prefetch" href="/assets/js/20.c6f145a7.js"><link rel="prefetch" href="/assets/js/21.96ad3811.js"><link rel="prefetch" href="/assets/js/22.e12d52e2.js"><link rel="prefetch" href="/assets/js/23.5d518d64.js"><link rel="prefetch" href="/assets/js/24.7681a4d8.js"><link rel="prefetch" href="/assets/js/25.3a25fa62.js"><link rel="prefetch" href="/assets/js/26.07718401.js"><link rel="prefetch" href="/assets/js/27.8743f90e.js"><link rel="prefetch" href="/assets/js/28.b4d6b486.js"><link rel="prefetch" href="/assets/js/29.aedc0020.js"><link rel="prefetch" href="/assets/js/3.3c077cdd.js"><link rel="prefetch" href="/assets/js/30.64c38825.js"><link rel="prefetch" href="/assets/js/31.90d7dc8b.js"><link rel="prefetch" href="/assets/js/32.5ccb0e26.js"><link rel="prefetch" href="/assets/js/33.8fb12054.js"><link rel="prefetch" href="/assets/js/34.814b9e5c.js"><link rel="prefetch" href="/assets/js/35.314a3788.js"><link rel="prefetch" href="/assets/js/36.dd90c802.js"><link rel="prefetch" href="/assets/js/37.ea6b2a06.js"><link rel="prefetch" href="/assets/js/38.be6dbf17.js"><link rel="prefetch" href="/assets/js/39.4fbc7ab4.js"><link rel="prefetch" href="/assets/js/4.b333c14c.js"><link rel="prefetch" href="/assets/js/40.e65caa31.js"><link rel="prefetch" href="/assets/js/41.36d65bc4.js"><link rel="prefetch" href="/assets/js/42.afc24694.js"><link rel="prefetch" href="/assets/js/43.ba56bb37.js"><link rel="prefetch" href="/assets/js/44.a078d196.js"><link rel="prefetch" href="/assets/js/45.53beecc1.js"><link rel="prefetch" href="/assets/js/46.d713aee5.js"><link rel="prefetch" href="/assets/js/47.ace7ed80.js"><link rel="prefetch" href="/assets/js/48.aa3d5ea2.js"><link rel="prefetch" href="/assets/js/49.e0cc3e5c.js"><link rel="prefetch" href="/assets/js/5.80d7978e.js"><link rel="prefetch" href="/assets/js/50.2bffebce.js"><link rel="prefetch" href="/assets/js/51.3bb2197c.js"><link rel="prefetch" href="/assets/js/52.30d5a6ab.js"><link rel="prefetch" href="/assets/js/53.86f280a5.js"><link rel="prefetch" href="/assets/js/54.bec1da07.js"><link rel="prefetch" href="/assets/js/55.6890ba67.js"><link rel="prefetch" href="/assets/js/56.78f10d2c.js"><link rel="prefetch" href="/assets/js/57.4d10bb23.js"><link rel="prefetch" href="/assets/js/58.e5bd72e0.js"><link rel="prefetch" href="/assets/js/59.1ccc193e.js"><link rel="prefetch" href="/assets/js/6.93c23e29.js"><link rel="prefetch" href="/assets/js/60.32570259.js"><link rel="prefetch" href="/assets/js/61.2f63bd25.js"><link rel="prefetch" href="/assets/js/62.942ce851.js"><link rel="prefetch" href="/assets/js/63.3ca6f01c.js"><link rel="prefetch" href="/assets/js/64.99d6a5a5.js"><link rel="prefetch" href="/assets/js/65.611f70c8.js"><link rel="prefetch" href="/assets/js/66.5fdebb0c.js"><link rel="prefetch" href="/assets/js/67.c69af9a7.js"><link rel="prefetch" href="/assets/js/68.f8e4e8b2.js"><link rel="prefetch" href="/assets/js/69.5a5e1c53.js"><link rel="prefetch" href="/assets/js/7.e0defabf.js"><link rel="prefetch" href="/assets/js/70.e15c66b9.js"><link rel="prefetch" href="/assets/js/71.d8817a6b.js"><link rel="prefetch" href="/assets/js/72.fddf5dc9.js"><link rel="prefetch" href="/assets/js/73.dab77603.js"><link rel="prefetch" href="/assets/js/74.8eddb38e.js"><link rel="prefetch" href="/assets/js/75.1a6011d1.js"><link rel="prefetch" href="/assets/js/76.9945f5b3.js"><link rel="prefetch" href="/assets/js/77.6ccffdef.js"><link rel="prefetch" href="/assets/js/78.4df66be0.js"><link rel="prefetch" href="/assets/js/79.f60eab5a.js"><link rel="prefetch" href="/assets/js/8.edeef7ca.js"><link rel="prefetch" href="/assets/js/80.e8dd7875.js"><link rel="prefetch" href="/assets/js/81.381e4258.js"><link rel="prefetch" href="/assets/js/82.f5d076b2.js"><link rel="prefetch" href="/assets/js/83.4af266b2.js"><link rel="prefetch" href="/assets/js/84.c8b235a0.js"><link rel="prefetch" href="/assets/js/85.e1f06807.js"><link rel="prefetch" href="/assets/js/86.de1b4ab9.js"><link rel="prefetch" href="/assets/js/87.6942ff22.js"><link rel="prefetch" href="/assets/js/88.4df7f839.js"><link rel="prefetch" href="/assets/js/89.7822a705.js"><link rel="prefetch" href="/assets/js/9.e81ad78e.js"><link rel="prefetch" href="/assets/js/90.b2708e26.js"><link rel="prefetch" href="/assets/js/91.e8a4fe8b.js"><link rel="prefetch" href="/assets/js/92.7ebcf313.js"><link rel="prefetch" href="/assets/js/94.8464a452.js"><link rel="prefetch" href="/assets/js/95.38ca9044.js"><link rel="prefetch" href="/assets/js/96.29241883.js"><link rel="prefetch" href="/assets/js/97.b99a8e9d.js"><link rel="prefetch" href="/assets/js/98.ee4911f9.js"><link rel="prefetch" href="/assets/js/99.b99346c9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e0cd40c5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档管理中心</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Third Party" class="dropdown-title"><span class="title">Third Party</span> <span class="arrow down"></span></button> <button type="button" aria-label="Third Party" class="mobile-dropdown-title"><span class="title">Third Party</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/third-party/arouter/" class="nav-link">
  ARouter
</a></li><li class="dropdown-item"><!----> <a href="/third-party/bugly/" class="nav-link">
  Bugly
</a></li><li class="dropdown-item"><!----> <a href="/third-party/dokka/" class="nav-link">
  Dokka
</a></li><li class="dropdown-item"><!----> <a href="/third-party/greendao/" class="nav-link">
  greenDAO
</a></li><li class="dropdown-item"><!----> <a href="/third-party/koin/" class="nav-link">
  Koin
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mars/" class="nav-link">
  Mars
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mmkv/" class="nav-link">
  MMKV
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mtj/" class="nav-link">
  百度移动统计
</a></li><li class="dropdown-item"><!----> <a href="/third-party/objectbox/" class="nav-link router-link-active">
  Objectbox
</a></li><li class="dropdown-item"><!----> <a href="/third-party/okhttp/" class="nav-link">
  OkHttp
</a></li><li class="dropdown-item"><!----> <a href="/third-party/orhanobut-logger/" class="nav-link">
  Orhanobut Logger
</a></li><li class="dropdown-item"><!----> <a href="/third-party/retrofit/" class="nav-link">
  Retrofit
</a></li><li class="dropdown-item"><!----> <a href="/third-party/rxjava/" class="nav-link">
  Rxjava
</a></li><li class="dropdown-item"><!----> <a href="/third-party/sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/third-party/umeng/" class="nav-link">
  友盟+
</a></li></ul></div></div><div class="nav-item"><a href="https://ruixiude.github.io/apidocs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线API文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Third Party" class="dropdown-title"><span class="title">Third Party</span> <span class="arrow down"></span></button> <button type="button" aria-label="Third Party" class="mobile-dropdown-title"><span class="title">Third Party</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/third-party/arouter/" class="nav-link">
  ARouter
</a></li><li class="dropdown-item"><!----> <a href="/third-party/bugly/" class="nav-link">
  Bugly
</a></li><li class="dropdown-item"><!----> <a href="/third-party/dokka/" class="nav-link">
  Dokka
</a></li><li class="dropdown-item"><!----> <a href="/third-party/greendao/" class="nav-link">
  greenDAO
</a></li><li class="dropdown-item"><!----> <a href="/third-party/koin/" class="nav-link">
  Koin
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mars/" class="nav-link">
  Mars
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mmkv/" class="nav-link">
  MMKV
</a></li><li class="dropdown-item"><!----> <a href="/third-party/mtj/" class="nav-link">
  百度移动统计
</a></li><li class="dropdown-item"><!----> <a href="/third-party/objectbox/" class="nav-link router-link-active">
  Objectbox
</a></li><li class="dropdown-item"><!----> <a href="/third-party/okhttp/" class="nav-link">
  OkHttp
</a></li><li class="dropdown-item"><!----> <a href="/third-party/orhanobut-logger/" class="nav-link">
  Orhanobut Logger
</a></li><li class="dropdown-item"><!----> <a href="/third-party/retrofit/" class="nav-link">
  Retrofit
</a></li><li class="dropdown-item"><!----> <a href="/third-party/rxjava/" class="nav-link">
  Rxjava
</a></li><li class="dropdown-item"><!----> <a href="/third-party/sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/third-party/umeng/" class="nav-link">
  友盟+
</a></li></ul></div></div><div class="nav-item"><a href="https://ruixiude.github.io/apidocs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线API文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/third-party/objectbox/" aria-current="page" class="sidebar-link">ObjectBox Java (Kotlin, Android)</a></li><li><a href="/third-party/objectbox/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/third-party/objectbox/tutoial-demo-project.html" class="sidebar-link">Tutorial: Demo Project</a></li><li><a href="/third-party/objectbox/entity-annotations.html" class="sidebar-link">Entity Annotations</a></li><li><a href="/third-party/objectbox/kotlin-support.html" class="sidebar-link">Kotlin Support</a></li><li><a href="/third-party/objectbox/queries.html" class="sidebar-link">ObjectBox Queries</a></li><li><a href="/third-party/objectbox/data-observers-and-rx.html" class="sidebar-link">Data Observers &amp; Rx</a></li><li><a href="/third-party/objectbox/relations.html" aria-current="page" class="active sidebar-link">Relations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#to-one-relations" class="sidebar-link">To-One Relations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#how-toone-works-behind-the-scenes" class="sidebar-link">How ToOne works behind the scenes</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#expose-the-toone-target-id-property" class="sidebar-link">Expose the ToOne target ID property</a></li></ul></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#initialization-magic" class="sidebar-link">Initialization Magic</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#improve-performance" class="sidebar-link">Improve Performance</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#to-many-relations" class="sidebar-link">To-Many Relations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#one-to-many-1-n" class="sidebar-link">One-to-Many (1:N)</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#many-to-many-n-m" class="sidebar-link">Many-to-Many (N:M)</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#access-many-to-many-in-the-reverse-direction" class="sidebar-link">Access Many-To-Many in the reverse direction</a></li></ul></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#updating-relations" class="sidebar-link">Updating Relations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#updating-toone" class="sidebar-link">Updating ToOne</a></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#updating-tomany" class="sidebar-link">Updating ToMany</a></li></ul></li><li class="sidebar-sub-header"><a href="/third-party/objectbox/relations.html#example-modelling-tree-relations" class="sidebar-link">Example: Modelling Tree Relations</a></li></ul></li><li><a href="/third-party/objectbox/data-browser.html" class="sidebar-link">Data Browser</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Android</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Advanced</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="relations"><a href="#relations" class="header-anchor">#</a> Relations</h1> <blockquote><p><em>Prefer to dive right into code? Check the relation project in the</em> <a href="https://github.com/objectbox/objectbox-examples/" target="_blank" rel="noopener noreferrer"><em>example repo</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><em>.</em></p></blockquote> <p>Objects may reference other objects, for example using a simple reference or a list of objects. In database terms, we call those references <strong>relations</strong>. The object defining the relation we call the <strong>source</strong> object, the referenced object we call <strong>target</strong> object. So the relation has a direction.</p> <p>If there is one target object, we call the relation <strong>to-one.</strong> And if there can be multiple target objects, we call it <strong>to-many</strong>. Relations are lazily initialized: the actual target objects are fetched from the database when they are first accessed. Once the target objects are fetched, they are cached for further accesses.</p> <p><img src="https://gblobscdn.gitbook.com/assets%2F-LETufmyus5LFkviJjr4%2F-LEhnjpwBGFJjnjm2CS7%2F-LEhpaYwoDzUlPHYOjdx%2FTo-One-2.png?alt=media&amp;token=2bf09315-cf09-4b71-b99a-12e03b165b0e" alt=""></p> <h2 id="to-one-relations"><a href="#to-one-relations" class="header-anchor">#</a> To-One Relations</h2> <p>You define a to-one relation using the <code>ToOne</code> class, a smart proxy to the target object. It gets and caches the target object transparently. For example, an order is typically made by one customer. Thus, we could model the <code>Order</code> class to have a to-one relation to the <code>Customer</code> like this:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Customer</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

<span class="token punctuation">}</span>


<span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Order</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token keyword">public</span> <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> customer<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Customer</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>


<span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Order</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> customer<span class="token operator">:</span> ToOne<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></section></div></div> <p>Now let’s add a customer and some orders. <strong>To set</strong> the related customer object, call <code>setTarget()</code> (or assign <code>target</code> in Kotlin) on the ToOne instance <strong>and put</strong> the order object:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Customer</span> customer <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Order</span> order <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setTarget</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Puts order and customer:</span>
<span class="token keyword">long</span> orderId <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> customer <span class="token operator">=</span>  <span class="token function">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> order <span class="token operator">=</span>  <span class="token function">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span>target <span class="token operator">=</span> customer
<span class="token comment">// Puts order and customer:</span>
<span class="token keyword">val</span> orderId <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Order<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></section></div></div> <p>If the customer object does not yet exist in the database, the ToOne will put it. If it already exists, the ToOne will only create the relation (but not put it). <strong>See further below for details about</strong> <a href="https://docs.objectbox.io/relations#updating-relations" target="_blank" rel="noopener noreferrer"><strong>updating relations</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><strong>.</strong></p> <blockquote><p><strong>Note:</strong> if your related entity uses self-assigned IDs with <code>@Id(assignable = true)</code> it will not be inserted. See below about <a href="https://docs.objectbox.io/relations#updating-toone" target="_blank" rel="noopener noreferrer">updating ToOne<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details.</p></blockquote> <p>To <strong>get</strong> the customer of an order call <code>getTarget()</code> (or access <code>target</code> in Kotlin) on the ToOne instance:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Order</span> order <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>orderId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Customer</span> customer <span class="token operator">=</span> order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> order <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Order<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">[</span>orderId<span class="token punctuation">]</span>
<span class="token keyword">val</span> customer <span class="token operator">=</span> order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span>target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section></div></div> <p>This will do a database call on the first access (lazy loading). It uses lookup by ID, which is very fast in ObjectBox. If you only need the ID instead of the whole target object, call <code>getTargetId()</code> instead. It can be more efficient because it does not touch the database at all.</p> <p>We can also <strong>remove</strong> the relationship to a customer:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code>order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setTarget</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code>order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span>target <span class="token operator">=</span>  <span class="token keyword">null</span>
boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Order<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section></div></div> <p>Note that this does not remove the customer from the database, it just dissolves the relationship.</p> <h3 id="how-toone-works-behind-the-scenes"><a href="#how-toone-works-behind-the-scenes" class="header-anchor">#</a> How ToOne works behind the scenes</h3> <p>If you look at your model in <code>objectbox-models/default.json</code> you can see, a ToOne property is not actually stored. Instead the ID of the target object is saved in a virtual property named like the ToOne property appended with <em>Id</em>.</p> <h3 id="expose-the-toone-target-id-property"><a href="#expose-the-toone-target-id-property" class="header-anchor">#</a> Expose the ToOne target ID property</h3> <p>You can directly access the target ID property by defining a <code>long</code> (or <code>Long</code> in Kotlin) property in your entity class with the expected name:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Order</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token keyword">public</span>  <span class="token keyword">long</span> customerId<span class="token punctuation">;</span> 

 <span class="token keyword">public</span> <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> customer<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Order</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span><span class="token punctuation">,</span>

 <span class="token keyword">var</span> customerId<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> customer<span class="token operator">:</span> ToOne<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></section></div></div> <p>You can change the name of the expected target ID property by adding the <a href="http://objectbox.io/files/objectbox-java/current/io/objectbox/annotation/TargetIdProperty.html" target="_blank" rel="noopener noreferrer">@TargetIdProperty(String)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> annotation to a ToOne.</p> <h2 id="initialization-magic"><a href="#initialization-magic" class="header-anchor">#</a> Initialization Magic</h2> <p>Did you notice that the <code>ToOne</code> field <code>customer</code> was never initialized in the code example above? Why can the code still use <code>customer</code> without any NullPointerException? Because the field actually is initialized – the initialization code just is not visible in your sources.</p> <p>The ObjectBox Gradle plugin will transform your entity class (<strong>only supported for plain Java and Android projects</strong>) to do the proper initialization in constructors before your code is executed. Thus, even in your constructor code, you can just assume <code>ToOne</code> and <code>ToMany</code>/ <code>List</code> properties have been initialized and are ready for you to use:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Example</span>  <span class="token punctuation">{</span>

 

 <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">&gt;</span></span> order<span class="token punctuation">;</span> 

 <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">&gt;</span></span> orders<span class="token punctuation">;</span>

 <span class="token keyword">transient</span> <span class="token class-name">BoxStore</span> __boxStore<span class="token punctuation">;</span> 

 <span class="token keyword">public</span>  <span class="token class-name">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">this</span><span class="token punctuation">.</span>order <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">Example_</span><span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">this</span><span class="token punctuation">.</span>orders <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">Example_</span><span class="token punctuation">.</span>orders<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token punctuation">}</span>

 <span class="token keyword">public</span>  <span class="token class-name">Example</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><blockquote><p>If your setup does not support transformations, like non-Android Kotlin code, add the above modifications yourself. You also will have to call <code>box.attach(entity)</code> before modifying ToOne or ToMany properties.</p></blockquote> <h2 id="improve-performance"><a href="#improve-performance" class="header-anchor">#</a> Improve Performance</h2> <p>To improve performance when ObjectBox constructs your entities, you should <strong>provide an all-properties constructor</strong>.</p> <p>For a ToOne you have to add an id parameter, typically named like the ToOne field appended with <code>Id</code> . Check your <code>objectbox-models/default.json</code> file to find the correct name.</p> <p>An example:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Order</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token keyword">public</span> <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> customer<span class="token punctuation">;</span>

 <span class="token keyword">public</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token punctuation">}</span>

 <span class="token keyword">public</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">,</span>  <span class="token keyword">long</span> customerId <span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>

 <span class="token keyword">this</span><span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setTargetId</span><span class="token punctuation">(</span>customerId<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="to-many-relations"><a href="#to-many-relations" class="header-anchor">#</a> To-Many Relations</h2> <p>To define a to-many relation, you can use a property of type <code>List</code> or the <code>ToMany</code> class. As the ToOne class, the <code>ToMany</code> class helps you to keep track of changes and to apply them to the database. If you do not need or want that, use type <code>List</code> and take care of applying database changes yourself.</p> <p>Note that <strong>to-many relations are resolved lazily</strong> on first access, and then <strong>cached</strong> in the source entity inside the <code>ToMany</code> object. So subsequent calls to any method, like <code>size()</code> of the <code>ToMany</code>, do not query the database, even if the relation was changed elsewhere. To get the latest data fetch the source entity again or call <code>reset()</code> on the <code>ToMany</code>.</p> <p>There is a slight difference if you require a one-to-many (1:N) or many-to-many (N:M) relation. A 1:N relation is like the example above where a customer can have multiple orders, but an order is only associated with a single customer. An example for an N:M relation are students and teachers: students can have classes by several teachers but a teacher can also instruct several students.</p> <h3 id="one-to-many-1-n"><a href="#one-to-many-1-n" class="header-anchor">#</a> One-to-Many (1:N)</h3> <p><img src="http://objectbox.io/wordpress/wp-content/uploads/2017/02/One-To-Many-2.png" alt="One-to-Many (1:N)"></p> <p>To define a one-to-many relation, you need to annotate your relation property with @Backlink. It links back to a to-one relation in the target object. Using the customer and orders example, we can modify the customer class to have a to-many relation to the customers orders:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels">&quot;&gt;<pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Customer</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token annotation punctuation">@Backlink</span><span class="token punctuation">(</span><span class="token keyword">to</span> <span class="token operator">=</span>  <span class="token string">&quot;customer&quot;</span><span class="token punctuation">)</span>

 <span class="token keyword">public</span> <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">&gt;</span></span> orders<span class="token punctuation">;</span>

<span class="token punctuation">}</span>



<span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Order</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token keyword">public</span> <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> customer<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Customer</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span> 

 <span class="token annotation builtin">@Backlink</span><span class="token punctuation">(</span><span class="token keyword">to</span>  <span class="token operator">=</span>  <span class="token string">&quot;customer&quot;</span><span class="token punctuation">)</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> orders<span class="token operator">:</span> ToMany<span class="token operator">&lt;</span>Order<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>



<span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Order</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> customer<span class="token operator">:</span> ToOne<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></section></div></div> <p><em>The</em> <code>_@Backlink_</code> <em>annotation tells ObjectBox which ToOne relation to use to populate the list of orders. If there would be multiple to-one relations using</em> <code>_Customer_</code> <em>inside the</em> <code>_Order_</code> <em>class, you would need to explicitly specify the name like</em> <code>_@Backlink(to = &quot;customer&quot;)_</code> <em>.</em></p> <p>Let’s <strong>add</strong> some orders together with a new customer. The ToMany implements the Java List interface, so we can simply add orders to it:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Customer</span> customer <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token string">&quot;Order 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token string">&quot;Order 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> customerId <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> customer <span class="token operator">=</span>  <span class="token function">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Order</span><span class="token punctuation">(</span>text <span class="token operator">=</span>  <span class="token string">&quot;Order 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Order</span><span class="token punctuation">(</span>text <span class="token operator">=</span>  <span class="token string">&quot;Order 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> customerId <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Customer<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></section></div></div> <blockquote><p><strong>For Kotlin:</strong> two data classes that have the same property values (excluding those defined in the class body) <a href="https://kotlinlang.org/docs/reference/data-classes.html" target="_blank" rel="noopener noreferrer">are equal and have the same hash code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Keep this in mind when working with ToMany which uses a HashMap to keep track of changes. E.g. adding the same data class multiple times has no effect, it is treated as the same entity.</p></blockquote> <p>If the order entities do not yet exist in the database, the ToMany will put them. If they already exist, the ToMany will only create the relation (but not put them). See further below for details about <a href="https://docs.objectbox.io/relations#updating-relations" target="_blank" rel="noopener noreferrer">updating relations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <blockquote><p><strong>Note:</strong> if your entities use self-assigned IDs with <code>@Id(assignable = true)</code> the above will not work. See below about <a href="https://docs.objectbox.io/relations#updating-tomany" target="_blank" rel="noopener noreferrer">updating ToMany<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details.</p></blockquote> <p>We can easily <strong>get</strong> the orders of a customer back by accessing the list of orders:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Customer</span> customer <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>customerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span>  <span class="token punctuation">(</span><span class="token class-name">Order</span> order <span class="token operator">:</span> customer<span class="token punctuation">.</span>orders<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> customer <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Customer<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>customerId<span class="token punctuation">)</span>
<span class="token keyword">for</span>  <span class="token punctuation">(</span>order <span class="token keyword">in</span> customer<span class="token punctuation">.</span>orders<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></section></div></div> <p><strong>Removing</strong> orders from the relation works as expected:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Order</span> order <span class="token operator">=</span> customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> order <span class="token operator">=</span> customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Customer<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section></div></div> <h3 id="many-to-many-n-m"><a href="#many-to-many-n-m" class="header-anchor">#</a> Many-to-Many (N:M)</h3> <p><img src="http://objectbox.io/wordpress/wp-content/uploads/2017/02/Many-To-Many-2.png" alt="Many-to-Many (N:M)"></p> <p>To define a many-to-many relation you simply add a property using the <code>ToMany</code> class. Assuming a students and teachers example, this is how a simple student class that has a to-many relation to teachers can look like:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Teacher</span><span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

<span class="token punctuation">}</span>



<span class="token annotation punctuation">@Entity</span>

<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Student</span><span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token keyword">public</span> <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher</span><span class="token punctuation">&gt;</span></span> teachers<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Teacher</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>



<span class="token annotation builtin">@Entity</span>

<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Student</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> teachers<span class="token operator">:</span> ToMany<span class="token operator">&lt;</span>Teacher<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></section></div></div> <p><strong>Adding</strong> the teachers of a student works exactly like with a list:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Teacher</span> teacher1 <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Teacher</span> teacher2 <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Student</span> student1 <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
student1<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher1<span class="token punctuation">)</span><span class="token punctuation">;</span>
student1<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Student</span> student2 <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
student2<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher2<span class="token punctuation">)</span><span class="token punctuation">;</span>

boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>student1<span class="token punctuation">,</span> student2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> teacher1 <span class="token operator">=</span>  <span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> teacher2 <span class="token operator">=</span>  <span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> student1 <span class="token operator">=</span>  <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
student1<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher1<span class="token punctuation">)</span>
student1<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher2<span class="token punctuation">)</span>

<span class="token keyword">val</span> student2 <span class="token operator">=</span>  <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
student2<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>teacher2<span class="token punctuation">)</span>

boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Student<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>student1<span class="token punctuation">,</span> student2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></section></div></div> <p>If the teacher entities do not yet exist in the database, the ToMany will also put them. If they already exist, the ToMany will only create the relation (but not put them). See further below for details about <a href="https://docs.objectbox.io/relations#updating-relations" target="_blank" rel="noopener noreferrer">updating relations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <blockquote><p><strong>Note:</strong> if your entities use self-assigned IDs with <code>@Id(assignable = true)</code> the above will not work. See below about <a href="https://docs.objectbox.io/relations#updating-tomany" target="_blank" rel="noopener noreferrer">updating ToMany<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for details.</p></blockquote> <p>To <strong>get</strong> the teachers of a student we just access the list:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Student</span> student <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>studentId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span>  <span class="token punctuation">(</span><span class="token class-name">Teacher</span> teacher <span class="token operator">:</span> student<span class="token punctuation">.</span>teachers<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> student <span class="token operator">=</span> boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span>Student<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>studentId<span class="token punctuation">)</span>
<span class="token keyword">for</span>  <span class="token punctuation">(</span>teacher <span class="token keyword">in</span> student<span class="token punctuation">.</span>teachers<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></section></div></div> <p>And if a student drops out of a class, we can <strong>remove</strong> a teacher from the relation:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code>student<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
student<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">applyChangesToDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code>student<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
student<span class="token punctuation">.</span>teachers<span class="token punctuation">.</span><span class="token function">applyChangesToDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section></div></div> <blockquote><p>Note: instead of using <code>put()</code> you can also use <code>applyChangesToDb()</code> of the <code>ToMany</code> to persist changes that affect it only.</p></blockquote> <h3 id="access-many-to-many-in-the-reverse-direction"><a href="#access-many-to-many-in-the-reverse-direction" class="header-anchor">#</a> Access Many-To-Many in the reverse direction</h3> <blockquote><p>Since 2.0.0</p></blockquote> <p>Following the above example, you might want an easy way to find out what students a teacher has. Instead of having to perform a query, you can just add a to-many relation to the teacher and annotate it with the <code>@Backlink</code> annotation:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Teacher</span><span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>
 <span class="token annotation punctuation">@Backlink</span><span class="token punctuation">(</span><span class="token keyword">to</span> <span class="token operator">=</span>  <span class="token string">&quot;teachers&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">public</span> <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">Student</span><span class="token punctuation">{</span>
  
 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">public</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>
 <span class="token keyword">public</span> <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher</span><span class="token punctuation">&gt;</span></span> teachers<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>
<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Teacher</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token annotation builtin">@Backlink</span><span class="token punctuation">(</span><span class="token keyword">to</span>  <span class="token operator">=</span>  <span class="token string">&quot;teachers&quot;</span><span class="token punctuation">)</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> students<span class="token operator">:</span> ToMany<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>



<span class="token annotation builtin">@Entity</span>
<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">Student</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> teachers<span class="token operator">:</span> ToMany<span class="token operator">&lt;</span>Teacher<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></section></div></div> <h2 id="updating-relations"><a href="#updating-relations" class="header-anchor">#</a> Updating Relations</h2> <p>The ToOne and ToMany relation classes assist you to persist the relation state. They keep track of changes and apply them to the database once you <strong>put the Object containing them</strong>. ObjectBox supports relation updates for new (not yet persisted; ID == 0) and existing (persisted before; ID != 0) Objects.</p> <p>For convenience, ToOne and ToMany will put Objects added to them if they do <strong>not yet exist</strong> (ID == 0). If they already <strong>exist</strong> (their ID != 0, or you are using <code>@Id(assignable = true)</code>), only the relation will be created or destroyed (internally the Object ID is added to or removed from the relation). In that case, to put changes to the properties of related Objects use their specific Box instead:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Order</span> orderToUpdate <span class="token operator">=</span> customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
orderToUpdate<span class="token punctuation">.</span>text <span class="token operator">=</span>  <span class="token string">&quot;Revised description&quot;</span><span class="token punctuation">;</span>
boxStore<span class="token punctuation">.</span><span class="token function">boxFor</span><span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>orderToUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="updating-toone"><a href="#updating-toone" class="header-anchor">#</a> Updating ToOne</h3> <p>The ToOne class offers the following methods to update the relation:</p> <ul><li><p><code>setTarget(target)</code> makes the given (new or existing) Object the new relation target; pass <code>null</code> to clear the relation.</p></li> <li><p><code>setTargetId(targetId)</code> sets the relation target based on the given ID of an existing Object; pass <code>0</code> (zero) to clear the relation.</p></li> <li><p><code>setAndPutTarget(target)</code> makes the given (new or existing) Object the new relation target and puts the owning, source Object and if needed the target Object.</p></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code>order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setTarget</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
orderBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setAndPutTarget</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><strong>Note:</strong> attach the Box before calling <code>setAndPutTarget()</code> on a new (not put) Object owning a ToOne:</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Order</span> order <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
orderBox<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setAndPutTarget</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><strong>Note:</strong> if the target Object uses self-assigned IDs with <code>@Id(assignable = true)</code>it will not be put when the Object that owns the relation is put. Read on for details:</p></blockquote> <p>If the target Object uses self-assigned IDs, put it before setting it as a target of the ToOne relation:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Customer</span> customer <span class="token operator">=</span>  <span class="token keyword">new</span>  <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span>id <span class="token operator">=</span>  <span class="token number">12</span><span class="token punctuation">;</span>
customerBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
order<span class="token punctuation">.</span>customer<span class="token punctuation">.</span><span class="token function">setTarget</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
orderBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>This is because <strong>ObjectBox only puts related entities with an ID of 0</strong>. See the <a href="https://docs.objectbox.io/advanced/object-ids" target="_blank" rel="noopener noreferrer">documentation about IDs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for background information.</p> <h3 id="updating-tomany"><a href="#updating-tomany" class="header-anchor">#</a> Updating ToMany</h3> <p>The ToMany relation class is a <code>java.lang.List</code> plus added change tracking for Objects. As <a href="https://docs.objectbox.io/relations#updating-relations" target="_blank" rel="noopener noreferrer">mentioned above<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, it will put new Objects (ID == 0) that are added to it once the Object owning it is put. And when removing Objects from it, just the relation is cleared, the Objects are not removed from their Box.</p> <p>See the documentation on <a href="https://docs.objectbox.io/relations#one-to-many-1-n" target="_blank" rel="noopener noreferrer">One-to-Many<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://docs.objectbox.io/relations#many-to-many-n-m" target="_blank" rel="noopener noreferrer">Many-to-Many<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> above for details.</p> <blockquote><p><strong>Note:</strong> if your entities are using self-assigned IDs with <code>@Id(assignable = true)</code> additional steps are required. Read on for details:</p></blockquote> <p>If the owning, source Object uses <code>@Id(assignable = true)</code> attach its Box before modifying its ToMany:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>customer<span class="token punctuation">.</span>id <span class="token operator">=</span>  <span class="token number">12</span><span class="token punctuation">;</span>
customerBox<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
customerBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>If the target Object, like <code>Order</code> above, is using self-assigned IDs put the target Objects before adding them to the ToMany relation:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>order<span class="token punctuation">.</span>id <span class="token operator">=</span>  <span class="token number">42</span><span class="token punctuation">;</span>
orderBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
customer<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
customerBox<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The above steps are required because, when putting the Object owning the ToMany only the relation is updated. This is because <strong>ObjectBox only puts target Objects with an ID of 0</strong>. See the <a href="https://docs.objectbox.io/advanced/object-ids" target="_blank" rel="noopener noreferrer">documentation about IDs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for background information.</p> <h2 id="example-modelling-tree-relations"><a href="#example-modelling-tree-relations" class="header-anchor">#</a> Example: Modelling Tree Relations</h2> <p>You can model a tree relation with a to-one and a to-many relation pointing to itself:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span>  <span class="token keyword">class</span>  <span class="token class-name">TreeNode</span>  <span class="token punctuation">{</span>

 <span class="token annotation punctuation">@Id</span>  <span class="token keyword">long</span> id<span class="token punctuation">;</span>

 <span class="token class-name">ToOne</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> parent<span class="token punctuation">;</span>

 <span class="token annotation punctuation">@BackLink</span>

 <span class="token class-name">ToMany</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> children<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Entity</span>
<span class="token keyword">data</span>  <span class="token keyword">class</span>  <span class="token function">TreeNode</span><span class="token punctuation">(</span>

 <span class="token annotation builtin">@Id</span>  <span class="token keyword">var</span> id<span class="token operator">:</span> Long <span class="token operator">=</span>  <span class="token number">0</span>

<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> parent<span class="token operator">:</span> ToOne<span class="token operator">&lt;</span>TreeNode<span class="token operator">&gt;</span>

 <span class="token annotation builtin">@Backlink</span>

 <span class="token keyword">lateinit</span>  <span class="token keyword">var</span> children<span class="token operator">:</span> ToMany<span class="token operator">&lt;</span>TreeNode<span class="token operator">&gt;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></section></div></div> <p>This lets you navigate a tree nodes parent and children:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="java" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">TreeNode</span> parent <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> children <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section> <section aria-hidden="true" id="kotlin" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> parent<span class="token operator">:</span> TreeNode <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>target
<span class="token keyword">val</span> children<span class="token operator">:</span> List<span class="token operator">&lt;</span>TreeNode<span class="token operator">&gt;</span>  <span class="token operator">=</span> treeNode<span class="token punctuation">.</span>children
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></section></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/third-party/objectbox/data-observers-and-rx.html" class="prev">
        Data Observers &amp; Rx
      </a></span> <span class="next"><a href="/third-party/objectbox/data-browser.html">
        Data Browser
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.708bd31f.js" defer></script><script src="/assets/js/2.1637da50.js" defer></script><script src="/assets/js/93.3a4310ca.js" defer></script>
  </body>
</html>
