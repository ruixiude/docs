(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{420:function(a,s,t){"use strict";t.r(s);var e=t(42),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"安装指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装指南"}},[a._v("#")]),a._v(" 安装指南")]),a._v(" "),t("h2",{attrs:{id:"基本要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本要求"}},[a._v("#")]),a._v(" 基本要求")]),a._v(" "),t("ul",[t("li",[a._v("MMKV 支持 API level 16 以上平台；")]),a._v(" "),t("li",[a._v("MMKV 需使用 NDK r16b 或以下进行编译 (通过源码引入 MMKV 的话)")])]),a._v(" "),t("h2",{attrs:{id:"安装引入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装引入"}},[a._v("#")]),a._v(" 安装引入")]),a._v(" "),t("h3",{attrs:{id:"通过-maven-推荐"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过-maven-推荐"}},[a._v("#")]),a._v(" 通过 Maven（推荐）")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("在 App 模块的 "),t("code",[a._v("build.gradle")]),a._v(" 文件里添加:")]),a._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[a._v("dependencies "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    implementation "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'com.tencent:mmkv-static:1.2.7'")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('// replace "1.2.7" with any available version')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("Gradle 在编译工程的时候会自动从 maven 仓库下载 AAR 包。")])]),a._v(" "),t("li",[t("p",[a._v("MMKV 默认以静态库形式链接 libc++。这个库如果动态链接，会额外占用 2MB 空间（解压后）。如果你已经有其他库引入了 "),t("code",[a._v("libc++_shared.so")]),a._v("，并且你确保他们的库没有版本兼容问题，你可以使用"),t("strong",[a._v("动态链接 libc++")]),a._v(" 的 MMKV，以进一步减少安装包大小：")]),a._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[a._v("dependencies "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    implementation "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'com.tencent:mmkv:1.2.7'")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('// replace "1.2.7" with any available version')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])])])]),a._v(" "),t("h3",{attrs:{id:"通过预先编译好的-aar-package"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过预先编译好的-aar-package"}},[a._v("#")]),a._v(" 通过预先编译好的 AAR Package")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("下载预先编译好的 AAR 包；")])]),a._v(" "),t("li",[t("p",[a._v("在 Android Studio 里点击 "),t("code",[a._v("File -> New -> New Module...")]),a._v(" 菜单并选择 "),t("code",[a._v('"Import JAR/AAR Package"')]),a._v("；")])]),a._v(" "),t("li",[t("p",[a._v("在 Android Studio 里点击 "),t("code",[a._v("File -> Project Structure...")]),a._v(" 菜单, 或者编辑 App 模块的 "),t("code",[a._v("build.gradle")]),a._v(" 文件，添加 MMKV 依赖:")]),a._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[a._v("dependencies "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    implementation "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("project")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("':mmkv'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])])])]),a._v(" "),t("h3",{attrs:{id:"通过编译源码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过编译源码"}},[a._v("#")]),a._v(" 通过编译源码")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("获取 MMKV 源码:")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("git clone https://github.com/Tencent/MMKV.git\ncd mmkv\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("下载安装 "),t("a",{attrs:{href:"https://developer.android.com/ndk/downloads/revision_history",target:"_blank",rel:"noopener noreferrer"}},[a._v("Android NDK r16b"),t("OutboundLink")],1),a._v(". 如果 Gradle 找不到 SDK 或 NDK，你需要在 "),t("code",[a._v("Android/MMKV/")]),a._v(" 目录创建文件 "),t("code",[a._v("local.properties")]),a._v("，输入以下内容：")]),a._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("sdk.dir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("path/to/sdk")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("ndk.dir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("path/to/ndk")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("注意：从 NDK r17 开始, Android 官方不再支持 "),t("code",[a._v("ARMv5 (armeabi)")]),a._v(" 架构。如果你的 App 确定不需要支持这个架构，那么你可以使用最新的 NDK 编译 MMKV。只需要从文件 "),t("code",[a._v("Android/MMKV/mmkv/build.gradle")]),a._v(" 里删掉这一行即可:")]),a._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[a._v("abiFilters "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'armeabi'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'armeabi-v7a'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'arm64-v8a'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'x86'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'x86_64'")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])])]),a._v(" "),t("li",[t("p",[a._v("用 Android Studio 打开项目目录 "),t("code",[a._v("Android/MMKV")]),a._v(" 即可编译 MMKV，你也可以从命令行编译：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("cd Android/MMKV\n./gradlew build\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])])])]),a._v(" "),t("p",[t("strong",[a._v("注:")]),a._v(" 如果你确定不需要加密功能，你可以在"),t("code",[a._v("Core/MMKVPredef.h")]),a._v(" 文件中打开宏"),t("code",[a._v("MMKV_DISABLE_CRYPT")]),a._v("，以减小一些二进制大小。")])])}),[],!1,null,null,null);s.default=n.exports}}]);