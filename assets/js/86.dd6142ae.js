(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{445:function(t,e,a){"use strict";a.r(e);var s=a(42),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"data-model-updates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-model-updates"}},[t._v("#")]),t._v(" Data Model Updates")]),t._v(" "),a("p",[t._v("How to rename entities and properties, change property types in ObjectBox.")]),t._v(" "),a("h2",{attrs:{id:"objectbox-data-model-updates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#objectbox-data-model-updates"}},[t._v("#")]),t._v(" ObjectBox - Data Model Updates")]),t._v(" "),a("p",[t._v("ObjectBox manages its data model (schema) mostly automatically. The data model is defined by the entity classes you define. When you "),a("strong",[t._v("add or remove")]),t._v(" entities or properties of your entities, "),a("strong",[t._v("ObjectBox takes care")]),t._v(" of those changes without any further action from you.")]),t._v(" "),a("p",[t._v("For other changes like "),a("strong",[t._v("renaming or changing the type")]),t._v(", ObjectBox needs "),a("strong",[t._v("extra information")]),t._v(" to make things unambiguous. This works using unique IDs (UIDs) and an "),a("code",[t._v("@Uid")]),t._v(" annotation, as we will see below.")]),t._v(" "),a("h2",{attrs:{id:"uids"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uids"}},[t._v("#")]),t._v(" UIDs")]),t._v(" "),a("p",[t._v("ObjectBox keeps track of entities and properties by assigning them unique IDs (UIDs). All those UIDs are stored in a file “objectbox-models/default.json”, which you should add to your version control system (e.g. git). If you are interested, we have "),a("a",{attrs:{href:"https://docs.objectbox.io/advanced/meta-model-ids-and-uids",target:"_blank",rel:"noopener noreferrer"}},[t._v("in-depth documentation on UIDs and concepts"),a("OutboundLink")],1),t._v(". But let’s continue with how to rename entities or properties.")]),t._v(" "),a("p",[a("strong",[t._v("In short:")]),t._v(" To make UID-related changes, put an  "),a("code",[t._v("@Uid")]),t._v(" annotation on the entity or property and build the project to get further instructions. Repeat for each entity or property to change.")]),t._v(" "),a("h2",{attrs:{id:"renaming-entities-and-properties"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#renaming-entities-and-properties"}},[t._v("#")]),t._v(" Renaming Entities and Properties")]),t._v(" "),a("p",[t._v("So why do we need that UID annotation? If you simply rename an entity class, ObjectBox only sees that the old entity is gone and a new entity is available. This can be interpreted in two ways:")]),t._v(" "),a("ul",[a("li",[t._v("The old entity is removed and a new entity should be added, the old data is discarded. This is the "),a("strong",[t._v("default behavior")]),t._v(" of ObjectBox.")]),t._v(" "),a("li",[t._v("The entity was renamed, the old data should be re-used.")])]),t._v(" "),a("p",[t._v("So to tell ObjectBox to do a rename instead of discarding your old entity and data, you need to make sure it knows that this is the same entity and not a new one. You do that by attaching the internal UID to the entity.")]),t._v(" "),a("p",[t._v("The same is true for properties.")]),t._v(" "),a("p",[t._v("Now let’s walk through how to do that. The process works the same if you want to rename a property:")]),t._v(" "),a("h2",{attrs:{id:"how-to-and-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-and-example"}},[t._v("#")]),t._v(" How-to and Example")]),t._v(" "),a("p",[a("strong",[t._v("Step 1:")]),t._v(" Add an empty "),a("code",[t._v("@Uid")]),t._v("  annotation to the entity/property you want to rename:")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Entity")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Uid")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyName")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("Step 2:")]),t._v(" Build the project. The build will fail with an error message that gives you the current UID of the entity/property:")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('error: [ObjectBox] UID operations for entity "MyName": \n  [Rename] apply the current UID using @Uid(6645479796472661392L) -\n  [Change/reset] apply a new UID using @Uid(4385203238808477712L)\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("Step 3:")]),t._v(" Apply the UID from the [Rename] section of the error message to your entity/property:")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Entity")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Uid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6645479796472661392L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyName")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("Step 4:")]),t._v(" The last thing to do is the actual rename on the language level (Java, Kotlin, etc.):")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Entity")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Uid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6645479796472661392L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyNewName")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("Step 5:")]),t._v(" Build the project again, it should now succeed. You can now use your renamed entity/property as expected and all existing data will still be there.")]),t._v(" "),a("p",[a("strong",[t._v("Repeat")]),t._v(" the steps above to rename another entity or property.")]),t._v(" "),a("blockquote",[a("p",[t._v("Note: Instead of the above you can also find the UID of the entity/property in the ObjectBox default.json file yourself and add it together with the @Uid annotation before renaming your entity/property. This can be "),a("strong",[t._v("faster when renaming multiple properties")]),t._v(".")])]),t._v(" "),a("h2",{attrs:{id:"changing-property-types"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#changing-property-types"}},[t._v("#")]),t._v(" Changing Property Types")]),t._v(" "),a("p",[t._v("ObjectBox does not support migrating existing property data to a new type. You will have to take care of this yourself, e.g. by keeping the old property and adding some migration logic.")]),t._v(" "),a("p",[t._v("There are two solutions to changing the type of a property:")]),t._v(" "),a("ul",[a("li",[t._v("Add a new property with a different name (this only works if the property has no @Uid annotation already):")])]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// old:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// new:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" yearInt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("ul",[a("li",[t._v("Set a new UID for the property so ObjectBox treats it as a new property. Let’s walk through how to do that:")])]),t._v(" "),a("h3",{attrs:{id:"how-to-and-example-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-and-example-2"}},[t._v("#")]),t._v(" "),a("strong",[t._v("How-to and Example")])]),t._v(" "),a("p",[a("strong",[t._v("Step 1:")]),t._v(" Add the  "),a("code",[t._v("@Uid")]),t._v(" annotation to the property where you want to change the type:")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Uid")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[a("strong",[t._v("Step 2:")]),t._v(" Build the project. The build will fail with an error message that gives you a newly created UID value:")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('error: [ObjectBox] UID operations for property "MyEntity.year": \n  [Rename] apply the current UID using @Uid(6707341922395832766L) -\n  [Change/reset] apply a new UID using @Uid(9204131405652381067L)\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("Step 3:")]),t._v(" Apply the UID from the [Change/reset] section to your property:")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Uid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9204131405652381067L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" year"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[a("strong",[t._v("Step 4:")]),t._v(" Build the project again, it should now succeed. You can now use the property in your entity as if it were a new one.")]),t._v(" "),a("p",[a("strong",[t._v("Repeat")]),t._v(" the steps above to change the type of another property.")])])}),[],!1,null,null,null);e.default=n.exports}}]);