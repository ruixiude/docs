(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{385:function(t,a,e){"use strict";e.r(a);var r=e(42),s=Object(r.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"符号表配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#符号表配置"}},[t._v("#")]),t._v(" 符号表配置")]),t._v(" "),e("h2",{attrs:{id:"介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),e("h3",{attrs:{id:"什么是符号表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是符号表"}},[t._v("#")]),t._v(" 什么是符号表？")]),t._v(" "),e("p",[t._v("符号表是内存地址与函数名、文件名、行号的映射表。符号表元素如下所示：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<起始地址> <结束地址> <函数> [<文件名:行号>]\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"为什么要配置符号表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么要配置符号表"}},[t._v("#")]),t._v(" 为什么要配置符号表？")]),t._v(" "),e("p",[t._v("为了能快速并准确地定位用户 APP 发生 "),e("strong",[t._v("Crash 的代码位置")]),t._v("，Bugly 使用"),e("strong",[t._v("符号表")]),t._v("对 APP 发生 Crash 的程序"),e("strong",[t._v("堆栈")]),t._v("进行"),e("strong",[t._v("解析")]),t._v("和"),e("strong",[t._v("还原")]),t._v("。")]),t._v(" "),e("p",[t._v("举一个例子：\n"),e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/3001.png?v=20200622202242",alt:"img"}})]),t._v(" "),e("p",[e("strong",[t._v("Bugly 提供了自动和手动两种方法配置 Android 符号表。")])]),t._v(" "),e("h2",{attrs:{id:"自动配置-使用-android-studio-插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自动配置-使用-android-studio-插件"}},[t._v("#")]),t._v(" 自动配置：使用 Android Studio 插件")]),t._v(" "),e("p",[e("strong",[t._v("Bugly 插件具有符号表文件上传功能，支持 "),e("a",{attrs:{href:"http://jcenter.bintray.com/com/tencent/bugly/symtabfileuploader",target:"_blank",rel:"noopener noreferrer"}},[t._v("JCenter 仓库"),e("OutboundLink")],1),t._v("和 "),e("a",{attrs:{href:"https://repo1.maven.org/maven2/com/tencent/bugly/symtabfileuploader",target:"_blank",rel:"noopener noreferrer"}},[t._v("Maven Central 仓库"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("p",[t._v("插件的配置和使用方法参考文档："),e("a",{attrs:{href:"https://bugly.qq.com/docs/utility-tools/plugin-gradle-bugly/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bugly 符号表插件使用指南"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"手动配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#手动配置"}},[t._v("#")]),t._v(" 手动配置")]),t._v(" "),e("p",[t._v("手动配置的流程如下：")]),t._v(" "),e("ul",[e("li",[t._v("下载最新版 "),e("strong",[e("a",{attrs:{href:"https://bugly.qq.com/v2/sdk?id=a82b9cd9-6c79-406f-ae81-64518b1559f8",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bugly Android 符号表工具"),e("OutboundLink")],1)]),t._v("，其中工具包中包括：\n"),e("ul",[e("li",[t._v("符号表工具 JAR 包（buglySymbolAndroid.jar）")]),t._v(" "),e("li",[t._v("Windows 的脚本（buglySymbolAndroid.bat）")]),t._v(" "),e("li",[t._v("Shell 脚本（buglySymbolAndroid.sh）")]),t._v(" "),e("li",[t._v("默认符号表配置文件（settings.txt）")]),t._v(" "),e("li",[t._v("符号表工具 Android 版 - 使用指南")])])]),t._v(" "),e("li",[t._v("根据 UUID 定位 Debug SO 文件")]),t._v(" "),e("li",[t._v("使用工具生成符号表文件（zip 文件）")]),t._v(" "),e("li",[t._v("在页面上传符号表文件")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/3003.png?v=20200622202242",alt:"img"}})]),t._v(" "),e("p",[e("strong",[t._v("其他说明")])]),t._v(" "),e("ul",[e("li",[t._v("如果项目只使用了混淆代码 (Proguard)，而没有 Native 工程，只需要直接上传 Proguard 生成的 Mapping 文件；")]),t._v(" "),e("li",[t._v("Bugly Android 符号表工具 2.5.0 及以上版本增加了上传功能，并支持 Mapping 文件的上传；")]),t._v(" "),e("li",[t._v("定位 Debug SO 文件的方法和工具的使用方法请参考：“符号表工具 Android 版 - 使用指南”。")])]),t._v(" "),e("h2",{attrs:{id:"符号表上传接口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#符号表上传接口"}},[t._v("#")]),t._v(" 符号表上传接口")]),t._v(" "),e("p",[t._v("Bugly 提供了上传符号表的 API 接口（使用 "),e("strong",[t._v("POST")]),t._v(" 方式上传）:")]),t._v(" "),e("ul",[e("li",[t._v("https://api.bugly.qq.com/openapi/file/upload/symbol")])]),t._v(" "),e("h4",{attrs:{id:"参数说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[t._v("#")]),t._v(" 参数说明")]),t._v(" "),e("p",[t._v("上传接口的参数说明如下：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("属性")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("api_version")]),t._v(" "),e("td",[t._v("API 版本，固定为 1")])]),t._v(" "),e("tr",[e("td",[t._v("app_id")]),t._v(" "),e("td",[t._v("App ID")])]),t._v(" "),e("tr",[e("td",[t._v("app_key")]),t._v(" "),e("td",[t._v("App Key")])]),t._v(" "),e("tr",[e("td",[t._v("symbolType")]),t._v(" "),e("td",[t._v("符号表类型，Mapping 为 1，Symbol 为 3")])]),t._v(" "),e("tr",[e("td",[t._v("bundleId")]),t._v(" "),e("td",[t._v("包名（Package）")])]),t._v(" "),e("tr",[e("td",[t._v("productVersion")]),t._v(" "),e("td",[t._v("版本号（Version Name）")])]),t._v(" "),e("tr",[e("td",[t._v("channel")]),t._v(" "),e("td",[t._v("渠道（channel）")])]),t._v(" "),e("tr",[e("td",[t._v("fileName")]),t._v(" "),e("td",[t._v("符号表文件名")])]),t._v(" "),e("tr",[e("td",[t._v("file")]),t._v(" "),e("td",[t._v("符号表文件")])])])]),t._v(" "),e("p",[e("strong",[t._v("其中包名、版本号、渠道和符号表文件名需要做 URL Encode。")])]),t._v(" "),e("h4",{attrs:{id:"例子-使用-curl-上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#例子-使用-curl-上传"}},[t._v("#")]),t._v(" 例子：使用 Curl 上传")]),t._v(" "),e("p",[t._v("使用 Curl 工具来上传的例子如下：")]),t._v(" "),e("ul",[e("li",[t._v("上传 Mapping 文件")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('curl -k "https://api.bugly.qq.com/openapi/file/upload/symbol?app_key=xxx&app_id=9000xxx" --form "api_version=1" --form "app_id=xxxxxx" --form "app_key=xxxxxx" --form "symbolType=1"  --form "bundleId=com.demo.test" --form "productVersion=1.0" --form "channel=xxx" --form "fileName=mapping.txt" --form "file=@mapping.txt" --verbose\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ul",[e("li",[t._v("上传符号表文件（Symbol 文件）")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('curl -k "https://api.bugly.qq.com/openapi/file/upload/symbol?app_key=xxx&app_id=9000xxx" --form "api_version=1" --form "app_id=xxxxxx" --form "app_key=xxxxxx" --form "symbolType=3"  --form "bundleId=com.demo.test" --form "productVersion=1.0" --form "fileName=symbol.zip" --form "file=@symbol.zip" --verbose\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h2",{attrs:{id:"debug-so-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#debug-so-文件"}},[t._v("#")]),t._v(" Debug SO 文件")]),t._v(" "),e("h3",{attrs:{id:"什么是-debug-so-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是-debug-so-文件"}},[t._v("#")]),t._v(" 什么是 Debug SO 文件？")]),t._v(" "),e("p",[t._v("Android 平台中，目标文件对应的是 SO 文件。Debug SO 文件是指具有调试信息的 SO 文件。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("为了方便找回Crash对应的Debug SO文件和还原堆栈，建议每次构建或者发布APP版本的时候，备份好Debug SO文件。\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"如何定位-debug-so-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何定位-debug-so-文件"}},[t._v("#")]),t._v(" 如何定位 Debug SO 文件？")]),t._v(" "),e("h4",{attrs:{id:"ide-eclipse"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ide-eclipse"}},[t._v("#")]),t._v(" IDE: Eclipse")]),t._v(" "),e("p",[t._v("IDE 如果使用 Eclipse+NDK，默认情况下，Debug SO 文件将位于： "),e("code",[t._v("<项目文件夹>/obj/local/<架构(Architecture)>/")])]),t._v(" "),e("p",[t._v("如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/debugSO.png?v=20200622202242",alt:"img"}})]),t._v(" "),e("h4",{attrs:{id:"ide-android-sutdio"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ide-android-sutdio"}},[t._v("#")]),t._v(" IDE: Android Sutdio")]),t._v(" "),e("p",[t._v("IDE 如果使用 Android Sutdio+NDK，默认情况下，"),e("strong",[t._v("Debug")]),t._v(" 编译的 Debug SO 文件将位于： "),e("code",[t._v("<项目文件夹>/<Module>/build/intermediates/ndk/debug/obj/local<架构>/")])]),t._v(" "),e("p",[t._v("而 "),e("strong",[t._v("Release")]),t._v(" 编译的 Debug SO 文件将位于： "),e("code",[t._v("<项目文件夹>/<Module>/build/intermediates/ndk/release/obj/local<架构>/")])]),t._v(" "),e("p",[t._v("如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/debugSO1.png?v=20200622202242",alt:"img"}})]),t._v(" "),e("h3",{attrs:{id:"如何判断是否与-crash-匹配"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何判断是否与-crash-匹配"}},[t._v("#")]),t._v(" 如何判断是否与 Crash 匹配？")]),t._v(" "),e("p",[e("strong",[t._v("Bugly v2.0 页面")])]),t._v(" "),e("p",[t._v("Bugly v1.0 还原 Crash 堆栈时，根据 App 包名、App 版本号、SO 文件名和架构来匹配符号表文件。")]),t._v(" "),e("ul",[e("li",[t._v("使用工具上传方式\n"),e("ul",[e("li",[t._v("检查生成符号表文件时输入的 SO 文件名和架构是否和 Crash 堆栈的 SO 文件匹配；")]),t._v(" "),e("li",[t._v("上传时指定的 App 包名、版本号是否和 Crash 对应的 App 包名和版本号匹配。")])])]),t._v(" "),e("li",[t._v("手动上传方式\n"),e("ul",[e("li",[t._v("检查生成符号表文件时输入的 SO 文件名和架构是否和 Crash 堆栈的 SO 文件匹配；")]),t._v(" "),e("li",[t._v("在版本管理页面下，检查符号表文件是否是在 Crash 对应 App 版本（包名和版本）下上传的。")])])])]),t._v(" "),e("p",[e("strong",[t._v("Bugly v2.0 页面")])]),t._v(" "),e("p",[t._v("Bugly v2.0 还原 Crash 堆栈时，需要根据 UUID 来匹配符号表文件，因此只有上传的符号表文件的 UUID 与 Crash 堆栈的 SO 文件的 UUID 一致时，才能准确地对堆栈进行还原。")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("查看符号表文件的 UUID（“"),e("a",{attrs:{href:"https://bugly.qq.com/docs/user-guide/symbol-configuration-android/?v=20200622202242#debug-souuid",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何查看 Debug SO 文件的 UUID？"),e("OutboundLink")],1),t._v("”）")])]),t._v(" "),e("li",[e("p",[t._v("查看 Crash 对应的 APP 的 UUID： 崩溃分析 ---\x3e Crash issue ---\x3e 符号表 ---\x3e UUID")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/UUID_SO.png?v=20200622202242",alt:"img"}})])])]),t._v(" "),e("h3",{attrs:{id:"如何查看-debug-so-文件的-uuid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何查看-debug-so-文件的-uuid"}},[t._v("#")]),t._v(" 如何查看 Debug SO 文件的 UUID？")]),t._v(" "),e("p",[t._v("符号表文件的 UUID 与 Debug SO 文件的 UUID 是一致的，因此可以通过符号表工具生成的符号表文件来查看 Debug SO 文件的 UUID：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("生成符号表文件(.zip) ---\x3e 解压符号表文件(.symbol) ---\x3e 使用文本编辑器打开符号表文件\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://bugly.qq.com/docs/img/symbol-android/UUID.png?v=20200622202242",alt:"img"}})]),t._v(" "),e("p",[t._v("其中符号表文件的 “SHA-1” 信息即 Debug SO 文件的 UUID，亦是符号表文件的 UUID，如果文件较大，建议使用 “Sublime Text” 等文本编辑器来打开符号表文件。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("由于Bugly v2.0已采用新的UUID计算规则，为了能正确地匹配Crash堆栈对应的SO文件，请使用2.5.0或以上版本的符号表工具。\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"找不到-crash-对应的-debug-so-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#找不到-crash-对应的-debug-so-文件"}},[t._v("#")]),t._v(" 找不到 Crash 对应的 Debug SO 文件？")]),t._v(" "),e("p",[t._v("如果本地已经无法找到 Crash 对应的符号表文件或者 Debug SO 文件了，但还能找回 Crash 对应的 APP 版本的 Native 工程代码，建议尝试重新用 NDK 编译出 Debug SO 文件并用符号表工具生成符号表文件。")]),t._v(" "),e("p",[t._v("如果连 Native 工程代码也无法找回了，那就真的无法还原这个 Crash 堆栈了。")]),t._v(" "),e("p",[e("strong",[t._v("为了防止出现这种情况，建议每次构建或者发布 APP 版本的时候，一定要备份好 Debug SO 文件！")])])])}),[],!1,null,null,null);a.default=s.exports}}]);